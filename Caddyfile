{
  email hjkim4842@gmail.com

# 전역 로그: Caddy 내부 이벤트용
  log {
        level INFO
        output file /var/log/caddy/system.log {
                                                roll_size 100MB
                                                roll_keep 5
                                                roll_keep_for 720h
                                              }
      }
}

# www → apex 영구 리다이렉트

www.sobok-app.com {
  redir https://sobok-app.com {uri} permanent
}

# 메인 사이트

sobok-app.com {
  encode zstd gzip

# 사이트별 접근 로그
  log {
        level INFO
        output file /var/log/caddy/access.log {
                                                roll_size 100MB
                                                roll_keep 5
                                              }
        format json
      }

  reverse_proxy spring-boot-app:8080

# 오류 응답만 커스터마이즈 (여기엔 log 넣지 마세요)
  handle_errors {
                  respond "{http.error.status_code} {http.error.status_text}"
                }
}